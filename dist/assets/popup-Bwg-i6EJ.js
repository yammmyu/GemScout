import{r as a,j as e,c as M}from"./index-CzqXxBXy.js";const P=()=>{const[c,i]=a.useState(!1),[o,x]=a.useState([]),[N,p]=a.useState(""),[h,n]=a.useState(""),[u,g]=a.useState(""),[w,l]=a.useState(0),[k,d]=a.useState(!1),[z,C]=a.useState(5),[m,b]=a.useState([]),[j,v]=a.useState("");a.useEffect(()=>{y(),chrome.tabs.query({active:!0,currentWindow:!0},s=>{var r;(r=s[0])!=null&&r.url&&p(s[0].url)})},[]);const y=async()=>{var s;try{const r=await chrome.storage.local.get(["jobs","lastJobAnalysis"]),t=r.jobs||[];if(x(t),(s=r.lastJobAnalysis)!=null&&s.timestamp){const J=new Date(r.lastJobAnalysis.timestamp).toLocaleString();g(`Last scan: ${J}`)}}catch(r){console.error("Failed to load jobs from storage:",r)}},f=async(s=5)=>{i(!0),n(""),l(0);const r=setInterval(()=>{l(t=>t>=90?t:t+Math.random()*20)},500);try{chrome.runtime.sendMessage({type:"start_discovery",maxJobs:s},async t=>{if(clearInterval(r),l(100),chrome.runtime.lastError){console.error("Error communicating with background script:",chrome.runtime.lastError),n("Failed to communicate with background script"),i(!1),l(0);return}t!=null&&t.success?(console.log("Discovery completed successfully:",t),n(""),await y(),t.jobs&&t.jobs.length>0?(console.log(`âœ… Found ${t.jobs.length} job(s)`),C(t.jobs.length),d(t.jobs.length>=s&&s<20),t.navigationPath&&(b(t.navigationPath),v(t.finalUrl||""),console.log("ðŸ§¦ Navigation path:",t.navigationPath))):(console.log("â„¹ï¸ No jobs found after search"),d(!1),b([]),v(""))):(console.error("Discovery failed:",t==null?void 0:t.error),n((t==null?void 0:t.error)||"Discovery failed"),d(!1)),setTimeout(()=>{i(!1),l(0)},500)})}catch(t){clearInterval(r),console.error("Error starting discovery:",t),n("Unexpected error occurred"),i(!1),l(0)}},A=async()=>{const[s]=await chrome.tabs.query({active:!0,currentWindow:!0});s.id&&chrome.tabs.sendMessage(s.id,{type:"TOGGLE_OVERLAY"})},S=()=>{chrome.runtime.openOptionsPage()},L=async()=>{try{await chrome.storage.local.remove(["jobs","lastJobAnalysis"]),x([]),g(""),console.log("Jobs cleared successfully")}catch(s){console.error("Failed to clear jobs:",s)}};return e.jsxs("div",{className:"w-96 max-h-96 overflow-y-auto bg-white",children:[e.jsxs("div",{className:"bg-blue-600 text-white p-4",children:[e.jsx("h1",{className:"text-xl font-bold mb-1",children:"GemScout"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"AI Job Discovery Assistant"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Current Page"}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:N||"Loading..."})]}),h&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:h})}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>f(5),disabled:c,className:"w-full bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded transition-colors flex items-center justify-center",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Scanning for Jobs..."]}):"Scan Current Page (Fast)"}),c&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${w}%`}})}),k&&!c&&e.jsxs("button",{onClick:()=>f(15),className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition-colors flex items-center justify-center text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Find More Jobs (Up to 15)"]})]}),e.jsx("button",{onClick:A,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded transition-colors",children:"Toggle Job Overlay"}),e.jsx("button",{onClick:S,className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded transition-colors",children:"Open Settings"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Discovered Jobs"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o.length>0&&e.jsx("button",{onClick:L,className:"text-xs text-gray-500 hover:text-red-600 px-2 py-1 rounded hover:bg-red-50 transition-colors",title:"Clear all jobs",children:"Clear"}),u&&e.jsx("span",{className:"text-xs text-gray-500",children:u})]})]}),m.length>1&&e.jsxs("div",{className:"mb-2 p-2 bg-blue-50 rounded border-l-4 border-blue-200",children:[e.jsx("p",{className:"text-xs text-blue-700 font-medium mb-1",children:"ðŸ§¦ AI Navigation Path:"}),e.jsx("div",{className:"text-xs text-blue-600",children:m.map((s,r)=>{const t=new URL(s).hostname;return e.jsxs("span",{children:[t,r<m.length-1&&e.jsx("span",{className:"mx-1 text-blue-400",children:"â†’"})]},r)})}),e.jsxs("p",{className:"text-xs text-blue-500 mt-1",children:["Found jobs at: ",j?new URL(j).pathname:"current page"]})]})]}),o.length>0?e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:o.map((s,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 hover:border-blue-300 transition-all duration-200",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"font-medium text-sm text-gray-900 line-clamp-2",children:s.title})}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-sm text-gray-700 font-medium",children:s.company}),e.jsxs("div",{className:"flex items-center justify-between",children:[s.location&&e.jsx("p",{className:"text-xs text-gray-500",children:s.location}),s.salary&&e.jsx("p",{className:"text-xs text-green-600 font-medium bg-green-50 px-2 py-1 rounded",children:s.salary})]})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:s.description}),e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs bg-blue-50 text-blue-700 px-3 py-1 rounded-full hover:bg-blue-100 transition-colors duration-200",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Job"]})]},r))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6.294a18.916 18.916 0 01-16 2.742 6.064 6.064 0 01-2-4.242V8a2 2 0 012-2h.294A18.916 18.916 0 0116 6z"})}),e.jsx("p",{className:"font-medium mb-1",children:"No jobs found yet"}),e.jsx("p",{className:"text-sm",children:'Click "Scan Current Page" to discover job opportunities'})]})]}),o.length>0&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"Jobs Found"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:"Ready"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Status"})]})]})})]})]})},F=document.getElementById("root"),E=M(F);E.render(e.jsx(P,{}));
